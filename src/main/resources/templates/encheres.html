<!DOCTYPE html>
<html lang="fr"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>Enchères</title>

    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/darkly/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/general.css}" rel="stylesheet">
</head>

<body>

<header th:replace="~{fragments/entete :: frag-entete}"></header>

<div class="text-center mt-3">
    <div th:if="${param.logout}" class="alert alert-success">
        Vous avez été déconnecté avec succès.
    </div>
</div>

<main class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-10 col-md-11">

            <div class="border rounded p-4 shadow">

                <h1 class="text-warning text-center mb-4">Liste des enchères</h1>

                <div th:if="${supError}" class="alert alert-warning text-center mb-3">
                    <h2 th:text="${supError}"></h2>
                </div>
                <div th:if="${success}" class="alert alert-success text-center mb-3">
                    <h2 th:text="${success}"></h2>
                </div>

                <form th:action="@{/encheresCategorie}" method="get" th:object="${articleVenduDto}">
                    <div class="d-flex justify-content-center flex-wrap mb-4">

                        <div class="col-md-4 m-3">
                            <label for="lettreRecherche" class="form-label">Filtres :</label>
                            <input type="text" name="lettreRecherche" id="lettreRecherche" class="form-control">
                        </div>

                        <div class="col-md-4 m-3">
                            <label for="noCategorie" class="form-label">Catégorie :</label>
                            <select id="noCategorie" th:field="*{noCategorie}" class="form-select">
                                <option th:each="categorie : ${@categorieServiceImpl.findAllCategorie()}"
                                        th:value="${categorie.noCategorie}"
                                        th:text="${categorie.libelle}">
                                </option>
                            </select>
                        </div>

                        <div class="col-12 text-center mt-3">
                            <button type="submit" class="btn btn-primary px-4">Rechercher</button>
                        </div>

                    </div>
                </form>

                <div class="d-flex flex-wrap justify-content-center">
                    <div class="card m-3" style="width: 18rem;" th:each="article : ${listeArticleVendu}">
                        <div class="card-body text-center">

                            <h3 class="card-title mb-2" th:text="${article.nomArticle}"></h3>

                            <p class="card-text mb-1">
                                Mise à prix : <span th:text="${article.miseAPrix}"></span> crédit
                            </p>

                            <p class="card-text mb-1">
                                Fin de l'enchère le
                                <span th:text="${#temporals.format(article.dateFinEnchere, 'dd/MM/yyyy')}"></span>
                                à
                                <span th:text="${#temporals.format(article.dateFinEnchere, 'HH:mm')}"></span>
                            </p>

                            <p class="card-text mb-2">
                                Vendeur :
                                <span th:text="${article.vendeur}" sec:authorize="isAnonymous()"></span>
                                <a th:href="@{/profilVendeur/{pseudo}(pseudo=${article.vendeur})}"
                                   th:text="${article.vendeur}"
                                   class="link-offset-2 link-underline link-underline-opacity-75"
                                   sec:authorize="isAuthenticated()"></a>
                            </p>

                            <a th:href="@{/detail-vente/{id}(id=${article.noArticle})}"
                               class="btn btn-primary"
                               sec:authorize="isAuthenticated()">Détail Vente</a>

                        </div>

                    </div>
                </div>
            </div>

        </div>

    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
